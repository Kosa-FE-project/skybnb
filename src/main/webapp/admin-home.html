<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Home</title>

<link rel="stylesheet" href="./home.css" />
<link rel="stylesheet" href="./css/style.css" />
<link rel="stylesheet" href="./css/reset.css" />
<link rel="stylesheet" href="./admin-home.css" />
<!-- bootStrap -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
<!-- Jquery (반드시 있어야 함!) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<!-- Chart.js (반드시 있어야 함!) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
<!-- jVectorMap Core (반드시 있어야 함!) -->
<script src="https://cdn.jsdelivr.net/npm/jvectormap@1.2.2/jquery-jvectormap.min.js"></script>
<!--  대한민국 지도 데이터 -->
<script src="./jquery-jvectormap-kr-mill.js"></script>
<script>
$(()=>{
	Chart.register(ChartDataLabels);
	
	//Age 차트
	const ageCtx=$('#chart-age-canvas');
	const ageData = {
			  labels: [
			    '20대',
			    '30대',
			    '40대',
			    '그 외'
			  ],
			  datasets: [{
			    label: '연령대별 이용객 데이터 수',
			    data: [4000, 3000, 500, 200],
			    backgroundColor: [
			      '#FF6B8A',
			      '#2D9CDB',
			      '#F2C94C',
			      '#C5CAE9'
			    ],
			   	hoverOffset: 25
			  }]
	};
	
	const ageConfig = {
			  type: 'doughnut',
			  data: ageData,
			  options: {
				  	maintainAspectRatio: false,
				  	responsive: true,
				  	radius : '80%',   // <-- 핵심, 기본은 100%
				    cutout: '60%',           // 도넛 두께 조절
				    plugins: {
				      legend: { 
				   			display: true,
		    	 			position: 'top',
		    	 			labels:{
		    	 			font: {
		    	 	            size: 12
		    	 	          },
		    	 	        boxWidth: 20,
		    	 	        boxHeight: 20
		    	 			}
				      },   // 범례 숨기기(원하면 true)
				      tooltip: { enabled: true },  // 툴팁 끄기(선택)
				      datalabels: {
				        // ① 표시할 내용: 퍼센트로 변환
				        formatter: (value, ctx) => {
				          const total = ctx.chart._metasets[0].total;      // v4
				          const pct   = (value / total * 100).toFixed(0);
				          return pct + '%';
				        },
				        // ② 위치·스타일
				        anchor: 'end',        // 밖으로 뺄 때 'end'
				        align: 'end',         // 선 밖 정렬: 'center'면 가운데
				        offset: 2,            // 원에서 얼마나 떨어질지
				        font: { weight: 'bold', size: 14 },
				        color: '#455A64'      // 글자색
				      }
				    }
				  }
			};
	new Chart(ageCtx,ageConfig);
	
	//Revenue 차트
	const revenueCtx=$('#chart-revenue-canvas');
	const revenueData = {
			labels : [
				'January','February','March','April','May','June','July','August','September','October',
			    'November','December'
			  ],
			  datasets: [{
				  label: '매출액',
				    data: [35000,45000,25000,35000,55000,60000,75000,85000,45000,55000,35000,65000],
				    backgroundColor: '#D6DAF6',
				    borderWidth: 2,
				    borderRadius: 10,
			  },
		/* 	  {
				  label: '예약건수',
				    data: [1500, 2000, 800, 2000, 3000, 2400, 4000, 5000, 2400, 1200, 2500, 4000],
				    backgroundColor: [
				      '#2D9CDB',
				    ],
				    borderWidth: 2,
				    borderRadius: 3,
			  } */
			  
			  ]
	}
	const revenuConfig = {
			  type: 'bar',
			  data: revenueData,
			  options: {
				maintainAspectRatio: false,
			    responsive: true,
			    scales: {
	    		    x: {
	    		      ticks: {
						maxRotation:45,
						minRotation:45,
	    		        font: {
	    		          size: 10 // 원하는 폰트 크기로 변경
	    		        }
	    		      }
	    		    },
			        y: {
			          min: 0 // Y축 최소값 설정
			        }
			  	},
				plugins: {
						legend: {
							position: 'top',
						},
				title: {
						display: true,
						text: 'Monthly revenue',
				       	font: {
				       		size: 30,
				       		color : '#3A3A3A',
				       		position: 'top', 
				       	}
						},
				tooltip: {
						enabled: true
						},
				datalabels: {
						display: false // 데이터 라벨 비활성화
				}
						
				}
			  },
			};
	new Chart(revenueCtx,revenuConfig);
	
	//Guest 차트
	const guestCtx=$('#chart-guest-canvas');
	const guestData = {
			  labels: [
			    'January','February','March','April','May','June','July','August','September','October',
			    'November','December'
			  ],
			  datasets: [{
			    label: '이용객',
			    data: [1500, 2000, 800, 2000, 3000, 2400, 4000, 5000, 2400, 1200, 2500, 4000],
			    borderColor: '#FF6B8A',
		     	backgroundColor: '#FF6B8A',
		      	tension: 0.4,
			  }]
	};
	const guestConfig = {
			  type: 'line',
			  data: guestData,
			  options: {
			  	maintainAspectRatio: false,
			  	responsive: true,
			  	scales: {
			        y: {
			          min: 0 // Y축 최소값 설정
			        }
			  	},
			    animations: {
			      radius: {
			        duration: 400,
			        easing: 'linear',
			        loop: (context) => context.active
			      }
			    },
			    hoverRadius: 5,
			    hoverBackgroundColor: 'yellow',
			    interaction: {
			      mode: 'nearest',
			      intersect: false,
			      axis: 'x'
			    },
			    plugins: {
			    	legend: { display: true,
			    				position : 'top',
			      	},
				    title: {
				        display: true,
				        text: 'Monthly Guest',
				       	font: {
				       		size: 30,
				       		color : '#3A3A3A',
				       		position: 'top', 
				       	}
				      },
			    	tooltip: {
			        	enabled: true
			      	},
			      	datalabels: {
	                    display: false // 데이터 라벨 비활성화
	                }
			    }
			  },
	};
	
	new Chart(guestCtx,guestConfig);
	
	//Map 부분
	const reservationData = {
	    "KR-11": 200, "KR-26": 550, "KR-27": 340, "KR-28": 670,
	    "KR-29": 290, "KR-30": 410, "KR-31": 180, "KR-41": 880,
	    "KR-42": 420, "KR-43": 310, "KR-44": 270, "KR-45": 370,
	    "KR-46": 490, "KR-47": 200, "KR-48": 330, "KR-49": 1500,
	    "KR-50": 120
	};
	
	const regionNamesKo = {
	  "KR-11": "서울", "KR-26": "부산", "KR-27": "대구", "KR-28": "인천",
	  "KR-29": "광주", "KR-30": "대전", "KR-31": "울산", "KR-41": "경기",
	  "KR-42": "강원", "KR-43": "충북", "KR-44": "충남", "KR-45": "전북",
	  "KR-46": "전남", "KR-47": "경북", "KR-48": "경남", "KR-49": "제주",
	  "KR-50": "세종"
	};

	$('.admin-map').vectorMap({
		map: 'kr_mill',
		backgroundColor: '#e0f7fa',
		zoomButtons: false, // 확대/축소 버튼 비활성화
	 	zoomOnScroll: true, // (선택) 휠 줌도 끄고 싶다면
		showTooltip: true,
		regionStyle: {
		  initial: { fill: '#CCCCCC' },
		  hover: { fill: '#5DADE2' },
		  selected: { fill: '#FF7043' }
		},
		series: {
		  regions: [{
		    values: {
		      "KR-11": "#FADBD8", "KR-26": "#D6EAF8", "KR-27": "#D5F5E3",
		      "KR-28": "#FCF3CF", "KR-29": "#F5EEF8", "KR-30": "#F9E79F",
		      "KR-31": "#E8DAEF", "KR-50": "#E0F7FA", "KR-41": "#FDEBD0",
		      "KR-42": "#D4E6F1", "KR-43": "#D1F2EB", "KR-44": "#FAD7A0",
		      "KR-45": "#FCF3CF", "KR-46": "#F9E79F", "KR-47": "#A9DFBF",
		      "KR-48": "#AED6F1", "KR-49": "#FADBD8"
		    },
		    attribute: 'fill'
		  }]
		},
	
		onRegionClick: function (event, code) {
		    const name = regionNamesKo[code] || code;
		    const count = reservationData[code] || 0;
		    $('.admin-map-list').text(`${name} 예약 수: ${count}건`);
		  },
	
		onLabelShow: function (event, label, code) {
			const name = regionNamesKo[code] || code;
			label.text(name);
		}
	
	});
    
});//ready
</script>
</head>
<body>

	<section class="home-bg">
		<div class="page-wrapper">
			<div class="container">Admin page</div>
		</div>
	</section>

	<section class="home-content">
		<div class="home-container page1">
			<!-- 여기는 스크롤 하면 같이 올라가는 애 쓰면 된당 -->
		</div>

		<div class="home-container page2 page-wrapper">

			<!-- 여기다 쭉쭉 만들면 된다 -->
			<div class="container">
				<div class="admin-dashboard">
					<!-- 상단 통계 -->
					<div class="admin-top-stats">
						<div class="admin-top-title">
							<h3>Statistics for 6</h3>
						</div>
						<div class="admin-top-card">
							<div class="admin-stat">
								<div class="admin-label">reservations</div>
								<div class="admin-value">186</div>
							</div>
							<div class="admin-stat">
								<div class="admin-label">monthly revenue</div>
								<div class="admin-value">$6,667</div>
							</div>
							<div class="admin-stat">
								<div class="admin-label">Today sales</div>
								<div class="admin-value">$198</div>
							</div>
							<div class="admin-stat">
								<div class="admin-label">average daily sales</div>
								<div class="admin-value">$222</div>
							</div>
						</div>
					</div>

					<!-- 중간 차트 -->
					<div class="admin-middle-charts">
						<div class="admin-card admin-chart">
							<canvas id="chart-age-canvas">Age Chart</canvas>
						</div>
						<div class="admin-card admin-chart">
							<canvas id="chart-revenue-canvas">Monthly Revenue</canvas>
						</div>
						<div class="admin-card admin-chart">
							<canvas id="chart-guest-canvas">Monthly Guest</canvas>
						</div>
					</div>

					<!-- 하단 지도 + 랭킹 -->
					<div class="admin-bottom-section">
						<div class="admin-map-card ">
							<div class="admin-map-wrrap">
								<div class="admin-list">
									<h4>지역별 예약 건수</h4>
									<div class="admin-map-list">
									</div>
								</div>
								<div class="admin-map"></div>
							</div>
						</div>
						<div class="admin-rank-card"><h2>Ranking</h2>
							<div>
								<p>1등 ??????게스트하우스</p>
								<p>2등 ??????게스트하우스</p>
								<p>3등 ??????게스트하우스</p>
								<p>4등 ??????게스트하우스</p>
								<p>5등 ??????게스트하우스</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
</body>
</html>